<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Friend Finder</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

</head>
<body>

  <div class="container">

    <div class="jumbotron">
      <h1 class="text-center">Survey!</h1>
      <hr>
      <h2 class="text-center">Answer all questions truthfully, or risk befriending an enemy...</h2>
      <br>

    </div>

    <div id="questions">
        <form>
            <div class="form-group">
                <label>Name:</label>
                <input id="name-input" class="form-control" type="text" placeholder="John Doe" required>
                <div class="invalid-feedback">
                    Please provide a name.
                </div>
            </div>
            <div class="form-group">
                <label>Photo URL:</label>
                <input id="photo-input" class="form-control" type="text" placeholder="www.picture-of-you-example.com" required>
                <div class="invalid-feedback">
                    Please provide a photo.
                </div>
            </div>
            <div class="form-group">
                    <label>You are a major pet person.</label> 
                <select class="custom-select" id="q1" required>
                    <option value="1">1 - strongly disagree</option>
                    <option value="2">2</option>
                    <option value="3">3 - neither agree nor disagree</option>
                    <option value="4">4</option>
                    <option value="5">5 - strongly agree</option>
                </select>
                <div class="invalid-feedback">Example invalid custom select feedback</div>
            </div>
            <div class="form-group">
                    <label>You like experimenting in regards to food.</label> 
                <select class="custom-select" id="q2" required>
                    <option value="1">1 - strongly disagree</option>
                    <option value="2">2</option>
                    <option value="3">3 - neither agree nor disagree</option>
                    <option value="4">4</option>
                    <option value="5">5 - strongly agree</option>
                </select>
                <div class="invalid-feedback">Example invalid custom select feedback</div>
            </div>
            <div class="form-group">
                    <label>You can watch the same movies again and again.</label> 
                <select class="custom-select" id="q3" required>
                    <option value="1">1 - strongly disagree</option>
                    <option value="2">2</option>
                    <option value="3">3 - neither agree nor disagree</option>
                    <option value="4">4</option>
                    <option value="5">5 - strongly agree</option>
                </select>
                <div class="invalid-feedback">Example invalid custom select feedback</div>
            </div>
            <div class="form-group">
                    <label>You enjoy watching sports.</label> 
                <select class="custom-select" id="q4" required>
                    <option value="1">1 - strongly disagree</option>
                    <option value="2">2</option>
                    <option value="3">3 - neither agree nor disagree</option>
                    <option value="4">4</option>
                    <option value="5">5 - strongly agree</option>
                </select>
                <div class="invalid-feedback">Example invalid custom select feedback</div>
            </div>
            <div class="form-group">
                    <label>Super speed is better than super strength.</label> 
                <select class="custom-select" id="q5" required>
                    <option value="1">1 - strongly disagree</option>
                    <option value="2">2</option>
                    <option value="3">3 - neither agree nor disagree</option>
                    <option value="4">4</option>
                    <option value="5">5 - strongly agree</option>
                </select>
                <div class="invalid-feedback">Example invalid custom select feedback</div>
            </div>
            <div class="form-group">
                    <label>You enjoy travelling.</label> 
                <select class="custom-select" id="q6" required>
                    <option value="1">1 - strongly disagree</option>
                    <option value="2">2</option>
                    <option value="3">3 - neither agree nor disagree</option>
                    <option value="4">4</option>
                    <option value="5">5 - strongly agree</option>
                </select>
                <div class="invalid-feedback">Example invalid custom select feedback</div>
            </div>
            <div class="form-group">
                    <label>Horror movies & haunted houses are super fun.</label> 
                <select class="custom-select" id="q7" required>
                    <option value="1">1 - strongly disagree</option>
                    <option value="2">2</option>
                    <option value="3">3 - neither agree nor disagree</option>
                    <option value="4">4</option>
                    <option value="5">5 - strongly agree</option>
                </select>
                <div class="invalid-feedback">Example invalid custom select feedback</div>
            </div>
            <div class="form-group">
                    <label>You think the world would be better if everyone was a lot more like you.</label> 
                <select class="custom-select" id="q8" required>
                    <option value="1">1 - strongly disagree</option>
                    <option value="2">2</option>
                    <option value="3">3 - neither agree nor disagree</option>
                    <option value="4">4</option>
                    <option value="5">5 - strongly agree</option>
                </select>
                <div class="invalid-feedback">Example invalid custom select feedback</div>
            </div>
            <div class="form-group">
                    <label>If 1 is West Coast, and 5 is East Coast, where do you want to live?</label> 
                <select class="custom-select" id="q9" required>
                    <option value="1">1 - West Coast</option>
                    <option value="2">2</option>
                    <option value="3">3 - Midwest</option>
                    <option value="4">4</option>
                    <option value="5">5 - East Coast</option>
                </select>
                <div class="invalid-feedback">Example invalid custom select feedback</div>
            </div>
            <div class="form-group">
                    <label>A hotdog is a sandwich.</label> 
                <select class="custom-select" id="q10" required>
                    <option value="1">1 - strongly disagree</option>
                    <option value="2">2</option>
                    <option value="3">3 - neither agree nor disagree</option>
                    <option value="4">4</option>
                    <option value="5">5 - strongly agree</option>
                </select>
                <div class="invalid-feedback">Example invalid custom select feedback</div>
            </div>

            <div class="text-center">
                <a href=""><button type="submit" id="submit" class="btn btn-lg btn-primary btn-block" >Get Results!</button></a>
            </div>
        </form>
    </div>

   

    <!-- Modal -->
    <div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitle">Meet Your New Friend!</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div id="displayFriend" class="modal-body">
                    <h3>Name: <span id="friendName"></span></h3>
                    <img id="friendPhoto" alt="friend match picture" width="300" height="200">
                    <p>Congratulations, you have offered yourself to eternal friendship. The bond cannot be broken.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
      <div class="container">
        <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/mangodyl/friend-finder">Github Repo</a>
      </div>
    </footer>

  </div>

  <script type="text/javascript">

    $(function() {

        $("#submit").on("click", function (event) {
            event.preventDefault();

            let nameInput = $("#name-input").val().trim();
            let photoInput = $("#photo-input").val().trim();

            if (nameInput !== "" && photoInput.match(/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)) {
                const newFriend = {
                    name: nameInput,
                    photo: photoInput,
                    scores: [
                        parseInt($("#q1").val()),
                        parseInt($("#q2").val()),
                        parseInt($("#q3").val()),
                        parseInt($("#q4").val()),
                        parseInt($("#q5").val()),
                        parseInt($("#q6").val()),
                        parseInt($("#q7").val()),
                        parseInt($("#q8").val()),
                        parseInt($("#q9").val()),
                        parseInt($("#q10").val()),
                    ]
                };

                console.log(newFriend);

                $.post("/api/friends", newFriend, data => {
                    console.log("By submitting this form, you are agreeing to a legally-binding contract whereby you must acknowledge your new best friend is such for the remainder of your life.");
                    $("#friendName").text(data.name);
                    $("#friendPhoto").attr("src", data.photo);
                });

                $('#modal').modal('show')
            }
            else {
                alert("Please fill in all the fields and make your selections");
            }
        });

        $('#modal').on('hide.bs.modal', function (e) {
            window.scrollTo(0, 0);
            setTimeout(location.reload(), 1000);
        });
    });

  </script>

</body>
</html>
